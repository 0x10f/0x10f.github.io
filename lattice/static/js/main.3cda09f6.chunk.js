(this["webpackJsonpfractal-frontend"]=this["webpackJsonpfractal-frontend"]||[]).push([[0],{13:function(e,t,i){e.exports=i(21)},18:function(e,t,i){},19:function(e,t,i){},20:function(e,t,i){},21:function(e,t,i){"use strict";i.r(t);var a=i(5),n=i.n(a),s=i(9),r=i.n(s),h=(i(18),i(19),i(1)),o=i(2),l=i(3),c=i(4),u=(i(20),i(0)),d=new Map,p=function(e){if(d.has(e))return d.get(e);var t=new u.D(e);return d.set(e,t),t},f=new Map,v=function(e){if(f.has(e))return f.get(e);var t=new u.c(e,e,e);return f.set(e,t),t},g=(new Map,new Map),w=function(e){if(g.has(e))return g.get(e);for(var t=new Uint8Array(e),i=0;i<=t.length;i++)t[i]=i/t.length*256;var a=new u.g(t,t.length,1,u.o);return a.minFilter=u.u,a.magFilter=u.u,a.generateMipmaps=!1,g.set(e,a),a},m=function(){function e(){Object(h.a)(this,e),this.group=new u.k}return Object(o.a)(e,[{key:"position",get:function(){return this.group.position}},{key:"scale",get:function(){return this.group.scale}}]),e}(),M=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e,a,n,s,r,o){var l;return Object(h.a)(this,i),(l=t.call(this)).shellGeometry=void 0,l.shellMaterial=void 0,l.shellMesh=void 0,l.highlightGeometry=void 0,l.highlightMaterial=void 0,l.highlightMesh=void 0,l.dotGeometry=void 0,l.dotMaterial=void 0,l.dotMesh=void 0,l.health=0,l.shellGeometry=v(e),l.shellMaterial=new u.t({color:a,gradientMap:w(n),side:u.b}),l.shellMesh=new u.r(l.shellGeometry,l.shellMaterial),l.shellMesh.renderOrder=1,l.group.add(l.shellMesh),l.highlightGeometry=v(e),l.highlightMaterial=new u.t({color:s,gradientMap:w(n),side:u.b}),l.highlightMesh=new u.r(l.highlightGeometry,l.highlightMaterial),l.highlightMesh.scale.multiplyScalar(r),l.highlightMesh.renderOrder=0,l.group.add(l.highlightMesh),l.dotGeometry=p(o),l.dotMaterial=new u.t({color:new u.f("#ff0000"),gradientMap:w(n)}),l.dotMesh=new u.r(l.dotGeometry,l.dotMaterial),l.dotMesh.scale.multiplyScalar(1.1),l.dotMesh.visible=!1,l.dotMesh.renderOrder=2,l.group.add(l.dotMesh),l}return Object(o.a)(i,[{key:"damage",value:function(e,t){if(this.dotMaterial.color.equals(t))return 0;var i=0;0===this.health?1===e?(this.dotMaterial.color=(new u.f).copy(t),this.dotMesh.visible=!0,this.health=1,i=1):(this.dotMaterial.color=(new u.f).copy(t),this.dotMesh.visible=!0,this.health=Math.floor(e/2),i=e-this.health):this.health-e<0?(this.dotMaterial.color=(new u.f).copy(t),this.dotMesh.visible=!0,this.health=Math.floor((e-this.health)/2),i=e-this.health):this.health-e===0?(this.dotMaterial.color=(new u.f).copy(this.shellMaterial.color),this.dotMesh.visible=!1,this.health=0,i=this.health):(this.health-=e,i=e);var a=Math.floor((this.health+100)/100)/6;return this.dotMesh.scale.set(1,1,1).multiplyScalar(a).multiplyScalar(1.1),i}}]),i}(m),y=function(e){return Math.floor((e+100)/100)/6},b=function(e,t){var i=e.getHSL({h:0,s:0,l:0}),a=i.h,n=i.s,s=i.l;return(s-=t)<0&&(s=0),(new u.f).setHSL(a,n,s)},O=function(e,t){return Math.floor(Math.random()*(t-e))+e},k=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e,a,n,s){var r;return Object(h.a)(this,i),(r=t.call(this)).team=e,r.health=a,r.start=n,r.path=s,r.shellGeometry=void 0,r.shellMaterial=void 0,r.shellMesh=void 0,r.outlineGeometry=void 0,r.outlineMaterial=void 0,r.outlineMesh=void 0,r.alpha=0,r.stepTime=0,r.stepSource=new u.I,r.easing=x(5.5),r.shellGeometry=p(6),r.shellMaterial=new u.t({color:e.color,gradientMap:w(10),side:u.j}),r.shellMesh=new u.r(r.shellGeometry,r.shellMaterial),r.shellMesh.renderOrder=1,r.group.add(r.shellMesh),r.outlineGeometry=p(6),r.outlineMaterial=new u.s({color:b(r.team.color,.2),side:u.b}),r.outlineMesh=new u.r(r.outlineGeometry,r.outlineMaterial),r.outlineMesh.scale.multiplyScalar(1.05),r.outlineMesh.renderOrder=0,r.group.add(r.outlineMesh),r.position.copy(r.stepSource),r.scale.multiplyScalar(y(r.health)),r.stepSource.copy(r.start),r}return Object(o.a)(i,[{key:"damage",value:function(e){this.health-=e,this.health<0&&(this.health=0),0!==this.health&&this.group.scale.set(1,1,1).multiplyScalar(y(this.health))}},{key:"update",value:function(e){if(!this.path.complete()){var t=this.path.peek(),i=(new u.I).addVectors(this.stepSource,t.delta());this.stepTime+=e,this.alpha=this.easing(this.stepTime/t.time),this.alpha>1&&(this.alpha=1),this.position.copy((new u.I).lerpVectors(this.stepSource,i,this.alpha)),1===this.alpha&&(this.path.poll(),this.stepSource=i,this.alpha=this.stepTime=0)}}},{key:"hasReachedVoxel",value:function(){return 0===this.alpha}},{key:"dead",value:function(){return 0===this.health||this.path.complete()}}]),i}(m),j=function(){function e(t){Object(h.a)(this,e),this.steps=t,this.index=0}return Object(o.a)(e,[{key:"peek",value:function(){return this.steps[this.index]}},{key:"poll",value:function(){return this.steps[this.index++]}},{key:"complete",value:function(){return this.index===this.steps.length}}]),e}(),I=function(){function e(t,i,a){Object(h.a)(this,e),this.direction=t,this.distance=i,this.time=a}return Object(o.a)(e,[{key:"delta",value:function(){return(new u.I).copy(this.direction.vector).multiplyScalar(this.distance)}}]),e}(),S=function e(t){Object(h.a)(this,e),this.vector=t};S.UP=new S(new u.I(0,1,0)),S.DOWN=new S(new u.I(0,-1,0)),S.LEFT=new S(new u.I(1,0,0)),S.RIGHT=new S(new u.I(-1,0,0)),S.FORWARD=new S(new u.I(0,0,1)),S.BACK=new S(new u.I(0,0,-1));var x=function(e){var t=function(t){return 1/(1+Math.exp(-e*t))-.5},i=.5/t(1);return function(e){return e=u.q.clamp(e,0,1),i*t(2*e-1)+.5}},A=function(){function e(t,i){Object(h.a)(this,e),this.id=t,this.color=i,e.ALL.set(t,this)}return Object(o.a)(e,null,[{key:"fromID",value:function(t){return e.ALL.get(t)}},{key:"count",value:function(){return e.ALL.size}}]),e}();A.ALL=new Map,A.TEAM_A=new A(0,(new u.f).setHSL(0,.5,.5)),A.TEAM_B=new A(1,(new u.f).setHSL(.4,.5,.5)),A.TEAM_C=new A(2,(new u.f).setHSL(.6,.5,.5)),A.TEAM_D=new A(3,(new u.f).setHSL(.8,.5,.5));var z=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e,a,n){var s;Object(h.a)(this,i),(s=t.call(this)).size=e,s.voxelSize=a,s.spacing=n,s.length=void 0,s.voxels=void 0,s.guidelines=void 0,s.tracers=new Array,s.tracerSpawnThreshold=300,s.tracerSpawnCounter=0,s.length=(s.size-1)*s.spacing,s.voxels=new Array(s.size);for(var r=0;r<s.size;r++){s.voxels[r]=new Array(s.size);for(var o=0;o<s.size;o++)s.voxels[r][o]=new Array(s.size)}for(var l=0;l<s.size;l++)for(var c=0;c<s.size;c++)for(var d=0;d<s.size;d++){var p=s.voxels[l][c][d]=new M(a,new u.f("#111111"),5,new u.f("#ffffff"),1.05,6);p.group.position.set(l*s.spacing-s.length/2,c*s.spacing-s.length/2,d*s.spacing-s.length/2),s.group.add(p.group)}return s.guidelines=new G(s.length,s.voxelSize,s.spacing),s.group.add(s.guidelines.segments),s}return Object(o.a)(i,[{key:"addTracer",value:function(e){this.tracers.push(e),this.group.add(e.group)}},{key:"update",value:function(e){if(this.tracerSpawnCounter++>this.tracerSpawnThreshold){for(var t=A.fromID(O(0,A.count())),i=O(1,500),a=new Array,n=new u.I(0,0,0),s=new u.I(0,0,0),r=0;r<32;r++){var h=S.UP;switch(O(0,6)){case 0:h=S.UP;break;case 1:h=S.DOWN;break;case 2:h=S.LEFT;break;case 3:h=S.RIGHT;break;case 4:h=S.FORWARD;break;case 5:h=S.BACK}var o=(new u.I).copy(h.vector).multiplyScalar(this.spacing),l=(new u.I).copy(s).add(o);l.x<-this.length/2||l.x>+this.length/2||l.y<-this.length/2||l.y>+this.length/2||l.z<-this.length/2||l.z>+this.length/2||(a.push(new I(h,this.spacing,1500)),s.copy(l))}var c=new k(t,i,n,new j(a));this.addTracer(c),this.tracerSpawnThreshold=64*Math.random(),this.tracerSpawnCounter=0}for(var d=[],p=0;p<this.tracers.length;p++){var f=this.tracers[p];if(f.update(e),f.hasReachedVoxel()){var v=this.getVoxelFromWorldCoordinates(f.position).damage(f.health,f.shellMaterial.color);f.damage(v)}f.dead()&&(this.group.remove(f.group),d.push(p))}for(var g=d.length-1;g>=0;g--)this.tracers.splice(d[g],1)}},{key:"getVoxelFromWorldCoordinates",value:function(e){var t=e.x,i=e.y,a=e.z;return this.getVoxel({x:(t+this.length/2)/this.spacing,y:(i+this.length/2)/this.spacing,z:(a+this.length/2)/this.spacing})}},{key:"getVoxel",value:function(e){var t=e.x,i=e.y,a=e.z;return this.voxels[t][i][a]}}]),i}(m),G=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e,a,n){var s;Object(h.a)(this,i),(s=t.call(this)).material=void 0,s.segments=void 0,s.material=new u.l({color:new u.f("#ffffff")});for(var r=e/2,o=new Array,l=-r;l<=r;l+=n)for(var c=-r;c<=r;c+=n)for(var d=-r;d<r;d+=n){var p=d+a/2,f=d+n-a/2,v=.1*(f-p);o.push(new u.I(l,c,p)),o.push(new u.I(l,c,p+v)),o.push(new u.I(l,c,f-v)),o.push(new u.I(l,c,f)),o.push(new u.I(l,p,c)),o.push(new u.I(l,p+v,c)),o.push(new u.I(l,f-v,c)),o.push(new u.I(l,f,c)),o.push(new u.I(p,l,c)),o.push(new u.I(p+v,l,c)),o.push(new u.I(f-v,l,c)),o.push(new u.I(f,l,c))}return s.segments=new u.m((new u.d).setFromPoints(o),s.material),s.segments.computeLineDistances(),s.group.add(s.segments),s}return i}(m),L=i(10),T=i(12),E=i(11),F=function(){function e(t){Object(h.a)(this,e),this.canvas=t,this.renderer=void 0,this.effects=void 0,this.camera=void 0,this.controls=void 0,this.scene=void 0,this.ambient=void 0,this.sun=void 0,this.lattice=void 0,this.renderer=new u.K({canvas:this.canvas,antialias:!0}),this.renderer.setSize(t.clientWidth,t.clientHeight),this.camera=new u.w(45,t.clientWidth/t.clientHeight,1,8e3),this.controls=new L.a(this.camera,this.canvas),this.controls.maxPolarAngle=Math.PI/2,this.controls.dampingFactor=.025,this.controls.enableDamping=!0,this.camera.position.set(400,400,400),this.controls.update(),this.scene=new u.B,this.scene.background=new u.f("#000000"),this.ambient=new u.a("#ffffff",1),this.scene.add(this.ambient),this.sun=new u.y("#ffffff",.5),this.sun.position.set(800,800,800),this.scene.add(this.sun),this.lattice=new z(9,16,100),this.scene.add(this.lattice.group),this.effects=new T.a(this.renderer),this.effects.addPass(new E.a(this.scene,this.camera))}return Object(o.a)(e,[{key:"draw",value:function(e){this.lattice.update(e),this.camera.aspect=this.canvas.clientWidth/this.canvas.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.controls.update(),this.effects.render()}}]),e}(),H=function(e){Object(c.a)(i,e);var t=Object(l.a)(i);function i(e){var a;return Object(h.a)(this,i),(a=t.call(this,e)).ref=n.a.createRef(),a.game=void 0,a}return Object(o.a)(i,[{key:"componentDidMount",value:function(){var e=this;this.ref.current&&(this.game=new F(this.ref.current));var t=performance.now();requestAnimationFrame((function i(a){e.game&&e.game.draw(a-t),t=a,requestAnimationFrame(i)}))}},{key:"render",value:function(){return n.a.createElement("canvas",{className:"stretch",ref:this.ref})}}]),i}(n.a.Component);var W=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(H,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.3cda09f6.chunk.js.map