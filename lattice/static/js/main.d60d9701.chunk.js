(this["webpackJsonpfractal-frontend"]=this["webpackJsonpfractal-frontend"]||[]).push([[0],{13:function(e,t,a){e.exports=a(21)},18:function(e,t,a){},19:function(e,t,a){},20:function(e,t,a){},21:function(e,t,a){"use strict";a.r(t);var i=a(5),r=a.n(i),n=a(9),s=a.n(n),h=(a(18),a(19),a(1)),o=a(2),l=a(3),c=a(4),u=(a(20),a(0)),d=new Map,p=function(e){if(d.has(e))return d.get(e);var t=new u.D(e,10,10);return d.set(e,t),t},f=new Map,g=function(e){if(f.has(e))return f.get(e);var t=new u.c(e,e,e);return f.set(e,t),t},v=(new Map,new Map),m=function(e){if(v.has(e))return v.get(e);for(var t=new Uint8Array(e),a=0;a<=t.length;a++)t[a]=a/t.length*256;var i=new u.g(t,t.length,1,u.o);return i.minFilter=u.u,i.magFilter=u.u,i.generateMipmaps=!1,v.set(e,i),i},w=function(){function e(){Object(h.a)(this,e),this.group=new u.k}return Object(o.a)(e,[{key:"position",get:function(){return this.group.position}}]),e}(),M=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,i,r,n,s,o){var l;return Object(h.a)(this,a),(l=t.call(this)).shellGeometry=void 0,l.shellMaterial=void 0,l.shellMesh=void 0,l.highlightGeometry=void 0,l.highlightMaterial=void 0,l.highlightMesh=void 0,l.dotGeometry=void 0,l.dotMaterial=void 0,l.dotMesh=void 0,l.health=0,l.shellGeometry=g(e),l.shellMaterial=new u.t({color:i,gradientMap:m(r),side:u.b}),l.shellMesh=new u.r(l.shellGeometry,l.shellMaterial),l.shellMesh.renderOrder=1,l.group.add(l.shellMesh),l.highlightGeometry=g(e),l.highlightMaterial=new u.t({color:n,gradientMap:m(r),side:u.b}),l.highlightMesh=new u.r(l.highlightGeometry,l.highlightMaterial),l.highlightMesh.scale.multiplyScalar(s),l.highlightMesh.renderOrder=0,l.group.add(l.highlightMesh),l.dotGeometry=p(o),l.dotMaterial=new u.t({color:new u.f("#ff0000"),gradientMap:m(r)}),l.dotMesh=new u.r(l.dotGeometry,l.dotMaterial),l.dotMesh.scale.multiplyScalar(1.1),l.dotMesh.visible=!1,l.dotMesh.renderOrder=2,l.group.add(l.dotMesh),l}return Object(o.a)(a,[{key:"damage",value:function(e,t){if(this.dotMaterial.color.equals(t))return 0;var a=0;0===this.health?1===e?(this.dotMaterial.color=(new u.f).copy(t),this.dotMesh.visible=!0,this.health=1,a=1):(this.dotMaterial.color=(new u.f).copy(t),this.dotMesh.visible=!0,this.health=Math.floor(e/2),a=e-this.health):this.health-e<0?(this.dotMaterial.color=(new u.f).copy(t),this.dotMesh.visible=!0,this.health=Math.floor((e-this.health)/2),a=e-this.health):this.health-e===0?(this.dotMaterial.color=(new u.f).copy(this.shellMaterial.color),this.dotMesh.visible=!1,this.health=0,a=this.health):(this.health-=e,a=e);var i=Math.floor((this.health+100)/100)/6;return this.dotMesh.scale.set(1,1,1).multiplyScalar(i).multiplyScalar(1.1),a}}]),a}(w),y=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,i){var r;Object(h.a)(this,a),(r=t.call(this)).health=e,r.radius=i,r.shellGeometry=void 0,r.shellMaterial=void 0,r.shellMesh=void 0,r.outlineGeometry=void 0,r.outlineMaterial=void 0,r.outlineMesh=void 0,r.alpha=0,r.accumulatedTime=0,r.pathSource=void 0,r.pathPoints=new Array,r.easing=function(e){var t=function(t){return 1/(1+Math.exp(-e*t))-.5},a=.5/t(1);return function(e){return e=u.q.clamp(e,0,1),a*t(2*e-1)+.5}}(5.5);var n=Math.floor(6*Math.random())/5,s=Math.floor((r.health+100)/100)/6;r.group.scale.multiplyScalar(s),r.shellGeometry=p(i),r.shellMaterial=new u.t({color:(new u.f).setHSL(n,.25,.5),gradientMap:m(10),side:u.j}),r.shellMesh=new u.r(r.shellGeometry,r.shellMaterial),r.shellMesh.renderOrder=1,r.group.add(r.shellMesh),r.outlineGeometry=p(i),r.outlineMaterial=new u.s({color:(new u.f).setHSL(n,.25,.3),side:u.b}),r.outlineMesh=new u.r(r.outlineGeometry,r.outlineMaterial),r.outlineMesh.scale.multiplyScalar(1.05),r.outlineMesh.renderOrder=0,r.group.add(r.outlineMesh);for(var o=Math.floor(32*Math.random()+1),l=new u.I(0,0,0),c=0;c<o;c++){switch(Math.floor(6*Math.random())){case 0:l.add(new u.I(100,0,0));break;case 1:l.add(new u.I(-100,0,0));break;case 2:l.add(new u.I(0,100,0));break;case 3:l.add(new u.I(0,-100,0));break;case 4:l.add(new u.I(0,0,100));break;case 5:l.add(new u.I(0,0,-100))}l.x>400||l.y>400||l.z>400||l.x<-400||l.y<-400||l.z<-400||r.pathPoints.push((new u.I).copy(l))}return r.pathSource=new u.I(0,0,0),r.group.position.copy(r.pathSource),r}return Object(o.a)(a,[{key:"update",value:function(e){if(this.pathPoints.length>0){var t=this.pathPoints[0];this.accumulatedTime+=e,this.alpha=this.easing(this.accumulatedTime/1500),this.alpha>1&&(this.alpha=1),this.group.position.copy((new u.I).lerpVectors(this.pathSource,t,this.alpha)),1===this.alpha&&(this.pathSource=this.pathPoints.shift(),this.alpha=0,this.accumulatedTime=0)}}},{key:"damage",value:function(e){if(this.health-=e,this.health<0&&(this.health=0),0!==this.health){var t=Math.floor((this.health+100)/100)/6;this.group.scale.set(1,1,1).multiplyScalar(t)}}},{key:"reachedVoxel",value:function(){return 0===this.alpha}},{key:"done",value:function(){return 0===this.health||0===this.pathPoints.length}}]),a}(w),b=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,i,r){var n;Object(h.a)(this,a),(n=t.call(this)).size=e,n.voxelSize=i,n.spacing=r,n.length=void 0,n.voxels=void 0,n.guidelines=void 0,n.tracers=new Array,n.tracerSpawnThreshold=300,n.tracerSpawnCounter=0,n.length=(n.size-1)*n.spacing,n.voxels=new Array(n.size);for(var s=0;s<n.size;s++){n.voxels[s]=new Array(n.size);for(var o=0;o<n.size;o++)n.voxels[s][o]=new Array(n.size)}for(var l=0;l<n.size;l++)for(var c=0;c<n.size;c++)for(var d=0;d<n.size;d++){var p=n.voxels[l][c][d]=new M(i,new u.f("#111111"),5,new u.f("#ffffff"),1.05,6);p.group.position.set(l*n.spacing-n.length/2,c*n.spacing-n.length/2,d*n.spacing-n.length/2),n.group.add(p.group)}return n.guidelines=new O(n.length,n.voxelSize,n.spacing),n.group.add(n.guidelines.segments),n}return Object(o.a)(a,[{key:"addTracer",value:function(e){this.tracers.push(e),this.group.add(e.group)}},{key:"update",value:function(e){if(this.tracerSpawnCounter++>this.tracerSpawnThreshold){var t=Math.floor(500*Math.random())+1,a=new y(t,6);this.addTracer(a),this.tracerSpawnThreshold=64*Math.random(),this.tracerSpawnCounter=0}for(var i=[],r=0;r<this.tracers.length;r++){var n=this.tracers[r];if(n.update(e),n.reachedVoxel()){var s=this.getVoxelFromWorldCoordinates(n.position).damage(n.health,n.shellMaterial.color);n.damage(s)}n.done()&&(this.group.remove(n.group),i.push(r))}for(var h=i.length-1;h>=0;h--)this.tracers.splice(i[h],1)}},{key:"getVoxelFromWorldCoordinates",value:function(e){var t=e.x,a=e.y,i=e.z;return this.getVoxel({x:(t+this.length/2)/this.spacing,y:(a+this.length/2)/this.spacing,z:(i+this.length/2)/this.spacing})}},{key:"getVoxel",value:function(e){var t=e.x,a=e.y,i=e.z;return this.voxels[t][a][i]}}]),a}(w),O=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e,i,r){var n;Object(h.a)(this,a),(n=t.call(this)).material=void 0,n.segments=void 0,n.material=new u.l({color:new u.f("#aaaaaa"),dashSize:5,gapSize:2});for(var s=e/2,o=new Array,l=-s;l<=s;l+=r)for(var c=-s;c<=s;c+=r)for(var d=-s;d<s;d+=r)o.push(new u.I(l,c,d+i/2)),o.push(new u.I(l,c,d+r-i/2)),o.push(new u.I(l,d+i/2,c)),o.push(new u.I(l,d+r-i/2,c)),o.push(new u.I(d+i/2,l,c)),o.push(new u.I(d+r-i/2,l,c));return n.segments=new u.m((new u.d).setFromPoints(o),n.material),n.segments.computeLineDistances(),n.group.add(n.segments),n}return a}(w),S=a(10),j=a(12),k=a(11),x=function(){function e(t){Object(h.a)(this,e),this.canvas=t,this.renderer=void 0,this.effects=void 0,this.camera=void 0,this.controls=void 0,this.scene=void 0,this.ambient=void 0,this.sun=void 0,this.lattice=void 0,this.renderer=new u.K({canvas:this.canvas,antialias:!0}),this.renderer.setSize(t.clientWidth,t.clientHeight),this.camera=new u.w(45,t.clientWidth/t.clientHeight,1,8e3),this.controls=new S.a(this.camera,this.canvas),this.controls.maxPolarAngle=Math.PI/2,this.controls.dampingFactor=.025,this.controls.enableDamping=!0,this.camera.position.set(400,400,400),this.controls.update(),this.scene=new u.B,this.scene.background=new u.f("#000000"),this.ambient=new u.a("#ffffff",1),this.scene.add(this.ambient),this.sun=new u.y("#ffffff",.5),this.sun.position.set(800,800,800),this.scene.add(this.sun),this.lattice=new b(9,16,100),this.scene.add(this.lattice.group),this.effects=new j.a(this.renderer),this.effects.addPass(new k.a(this.scene,this.camera))}return Object(o.a)(e,[{key:"draw",value:function(e){this.lattice.update(e),this.camera.aspect=this.canvas.clientWidth/this.canvas.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight),this.controls.update(),this.effects.render()}}]),e}(),z=function(e){Object(c.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(h.a)(this,a),(i=t.call(this,e)).ref=r.a.createRef(),i.game=void 0,i}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.ref.current&&(this.game=new x(this.ref.current));var t=performance.now();requestAnimationFrame((function a(i){e.game&&e.game.draw(i-t),t=i,requestAnimationFrame(a)}))}},{key:"render",value:function(){return r.a.createElement("canvas",{className:"stretch",ref:this.ref})}}]),a}(r.a.Component);var I=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(z,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[13,1,2]]]);
//# sourceMappingURL=main.d60d9701.chunk.js.map